/**
 * Copyright (c) 2025 FACIL'iti. All rights reserved.
 *
 * This file is subject to the terms of FACIL'iti.
 * Any unauthorized use, reproduction, or distribution of this file, in whole or in part,
 * is prohibited without the express written permission of FACIL'iti.
 * This project may include third-party libraries licensed under different terms.
 * Company Website: www.facil-iti.com
 */
var FACIL_ITI={};if(void 0===window.FilterV2){class FilterV2{updatedAt=null;logo=null;language="fr";filter={label:null};config=null;constructor(e){this.filter={label:e}}areThereAnyActiveFunctions(){return null!==this.config}}window.FilterV2=FilterV2}if(void 0===window.FilterStoreV2){class FilterStoreV2{version=2;activeFilter=null;mode="light-mode";language="fr-FR";filters=[];isActiveFilter(){return null!==this.activeFilter}getActiveFilter(){return this.activeFilter?this.activeFilter.id?this.filters.find(e=>e.filter.id===this.activeFilter.id):this.filters.find(e=>e.filter.label===this.activeFilter.label):null}static createFromStoreV1(e){if(1!==e.version&&void 0!==e.version)throw"Unable to convert: the filter store is not in a compatible version 1";var t,i=new FilterStoreV2;for(t in""!==e.active_profile&&(i.activeFilter={label:e.active_profile}),e.profiles){var n=new FilterV2(t);n.updatedAt=e.profiles[t].date,n.logo=e.profiles[t].logo,n.language=e.profiles[t].language,n.config=e.profiles[t].config,i.filters.push(n)}return i}static loadFromRawJsonObject(e){return Object.setPrototypeOf(e,FilterStoreV2.prototype),e.filters.forEach(e=>Object.setPrototypeOf(e,FilterV2.prototype)),e}}window.FilterStoreV2=FilterStoreV2}(f=>{f.POPIN_MANAGER={};{var m=f.POPIN_MANAGER;let r="FACIL_ITI_POPIN",t="https://web-service.facil-iti.app",s=!1,e,i,l=f.configuration;function h(){window.scrollTo(i,e)}let n=!1;try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){return n=!0,null}}))}catch{}let o=!!n&&{passive:!1};function w(){return{app_url:t,features:"env_1",ui:{css:{height:m.context().height-60+"px",width:"420px",position:"fixed",borderRadius:"20px",top:"30px",border:"2px solid white",display:"block"},position:(()=>{switch(l.popinPosition||(l.popinPosition="default"),l.popinPosition){case"left":case"right":return l.popinPosition;default:return"right"}})(),sideMargin:"30px",stylesheet:""}}}m.nodeMetaData=new WeakMap,m.disableScroll=()=>{e=window.pageYOffset||document.documentElement.scrollTop,i=window.pageXOffset||document.documentElement.scrollLeft,window.addEventListener("scroll",h,!1),window.addEventListener("DOMMouseScroll",h,!1),window.addEventListener("wheel",h,o),window.addEventListener("mousewheel",h,o),window.addEventListener("touchmove",h,o)},m.enableScroll=()=>{window.removeEventListener("scroll",h,!1),window.removeEventListener("DOMMouseScroll",h,!1),window.removeEventListener("wheel",h,o),window.removeEventListener("mousewheel",h,o),window.removeEventListener("touchmove",h,o)},m.popin=null,m.context=()=>{var e=document.documentElement.lang.split(/[-_]/)[0].toLowerCase(),t="fr"===e?"Solution de personnalisation de lâ€™affichage":"Display Personalization Solution";return{id:"popin-context",currentURL:window.location.href,width:window.innerWidth,height:window.innerHeight,lang:e,isDesktopView:600<window.innerWidth,isMobileView:window.innerWidth<=600,applicationIdentifier:void 0!==l?l.applicationIdentifier:null,uiVersion:void 0!==l?l.uiVersion:"default",environment:void 0!==l&&l.environment?l.environment:"production",iframeTitle:t}};let a={ui:{css:{height:"60vh",width:"100%",borderRadius:"20px 20px 0 0",bottom:"0px",position:"fixed",top:"auto",right:"0",left:"0",border:"none",borderTop:"2px solid white"},position:"left",sideMargin:"0"}},c={origin:{source:"tag",version:"cdn"}};function v(e){e.preventDefault(),f.POPIN_MANAGER.toggle()}m.isPopinOpen=()=>null!==document.querySelector("#"+r),m.toggle=(e=c)=>{f.iframePilote.isMainTag()?m.isPopinOpen()?m.close():m.open(e):window.top?.postMessage({popinAction:"toggle-popin"},"*")},m.redraw=()=>{var e=document.querySelector("#"+r),t=m.getMaxZIndexInUse();e&&t>parseInt(e.style.zIndex)&&(e.style.zIndex=t)},m.getMaxZIndexInUse=()=>[...document.querySelectorAll("body *")].map(e=>parseInt(getComputedStyle(e).zIndex)).filter(e=>!isNaN(e)).reduce((e,t)=>Math.max(e,t),1)+15,m.applyLayout=function(){try{var e,t,i=document.querySelector("#"+r),n=m.context().isDesktopView?w():Object.assign({},w(),a);for([e,t]of Object.entries(n.ui.css))i.style[e]=t}catch{}},m.applyConfiguration=()=>{try{document.querySelector("#"+r).contentWindow.postMessage(m.context(),"*")}catch{}},m.applyPosition=function(){var e=document.querySelector("#"+r),t=m.context().isDesktopView?w():Object.assign({},w(),a);"right"===t.ui.position?(e.style.right=t.ui.sideMargin,e.style.left="auto"):(e.style.left=t.ui.sideMargin,e.style.right="auto")},m.countOpening=function(e,t,i){["staging","integration"].includes(m.context().uiVersion)||(i=JSON.stringify(i),fetch(w().app_url+`/popin/opening/${e}/${t}/`+i,{method:"HEAD",mode:"no-cors"}).catch())},m.open=function(e=c){let t;m.popin?t=m.popin:((t=document.createElement("iframe")).setAttribute("role","alert"),t.setAttribute("aria-live","polite"),t.setAttribute("tabindex","0"),t.title=m.context().iframeTitle,t.src="staging"===m.context().uiVersion||"integration"===m.context().uiVersion?`https://cdn.facil-iti.app/gui/${m.context().uiVersion}/index.html?mode=popin&applicationIdentifier=${m.context().applicationIdentifier}&version=${m.context().uiVersion}&params=${JSON.stringify(e)}&environment=`+m.context().environment:`${w().app_url}/popin/router/${m.context().applicationIdentifier}/popin`,t.id=r,t.style.zIndex=m.getMaxZIndexInUse()+1,i=t,new MutationObserver(e=>{for(var t of e)"attributes"===t.type&&"scrolling"===t.attributeName&&"no"===i.getAttribute("scrolling")&&i.setAttribute("scrolling","yes")}).observe(i,{attributes:!0,attributeFilter:["scrolling","style"]}),m.popin=t),t.onload=m.applyConfiguration,document.body.appendChild(t),m.countOpening(l.applicationIdentifier,"popin",e),m.applyLayout(),m.applyPosition(),m.switchMode(s);var i,n,o=window.innerWidth,a=m.context().isDesktopView;m.context().isDesktopView;window.onresize=()=>{o!==window.innerWidth&&(o=window.innerWidth,n=m.context().isDesktopView,a!==n)&&(f.POPIN_MANAGER.applyLayout(),f.POPIN_MANAGER.applyPosition(),f.POPIN_MANAGER.switchMode(s),a=f.POPIN_MANAGER.context().isDesktopView,f.POPIN_MANAGER.applyConfiguration())},document.querySelector("#"+r).addEventListener("mouseenter",m.disableScroll),document.querySelector("#"+r).addEventListener("mouseleave",m.enableScroll),window.addEventListener("touch",m.enableScroll),setTimeout(()=>{t.focus&&t.focus(),t.contentWindow&&t.contentWindow.focus&&t.contentWindow.focus()},300)},m.close=function(){m.enableScroll(),document.querySelector("#"+r).removeEventListener("mouseenter",m.disableScroll),document.querySelector("#"+r).removeEventListener("mouseleave",m.enableScroll),window.removeEventListener("touch",m.enableScroll),document.querySelector("#"+r).remove();let e=document.querySelector("[data-faciliti-popin]");e&&setTimeout(()=>{e.focus&&e.focus()},100)},m.switchPosition=function(){var e=document.querySelector("#"+r).style;e.right===w().ui.sideMargin?(e.right="auto",e.left=w().ui.sideMargin):(e.left="auto",e.right=w().ui.sideMargin)},m.resizeWindow=function(){var e=document.querySelector("#"+r).style;e.height===a.ui.css.height?e.height="100%":e.height=a.ui.css.height},m.switchMode=function(e){var t=document.querySelector("#"+r);t&&(t.style.borderColor=e?"#ffffff":"#121212")},m.clearAllDataInStorage=function(t=!1){if(window.localStorage.removeItem("FACIL_ITI"),window.sessionStorage.removeItem("FACIL-ITI_CSS"),window.sessionStorage.removeItem("FACIL-ITI_url_blacklist"),window.sessionStorage.removeItem("FACIL_ITI_CACHE"),window.dispatchEvent(new StorageEvent("storage",{key:"FACIL_ITI"})),!t){let e;var t=document.querySelector("#FACIL_ITI_POPIN"),i=document.querySelector("#FACIL_ITI_INCONTENT");t&&(e=t.contentWindow||t).postMessage({popinAction:"delete-all-user-data-from-storage"},"*"),i&&(e=i.contentWindow||i).postMessage({popinAction:"delete-all-user-data-from-storage"},"*")}},m.setup=function(e){void 0===l&&(l=e),(e=>{e=document.querySelectorAll(e);e&&e.forEach(e=>{m.nodeMetaData.set(e,{toggleButtonActivated:!0}),e.addEventListener("click",v)})})('[data-faciliti-popin], a[href="https://ws.facil-iti.com"]'),u("#facil-iti"),p(),g()};let d=()=>{var e=window.location.href.replace(/#.*$/,"");window.history.replaceState("",document.title,e)},u=e=>{window.location.hash===e&&(f.POPIN_MANAGER.open(),d()),window.addEventListener("hashchange",function(){window.location.hash===e&&(f.POPIN_MANAGER.toggle(),d())},!1)},p=()=>{document.addEventListener("keydown",function(e){e.ctrlKey&&e.shiftKey&&"KeyF"===e.code&&f.POPIN_MANAGER.toggle()},!1)},g=()=>{window.addEventListener("message",e=>{if([t,"https://cdn.facil-iti.app","https://popin.wip"].includes(e.origin))switch(e.data.popinAction){case"switch-position":m.switchPosition();break;case"resize":m.resizeWindow();break;case"close":m.close();break;case"switch-mode":s=e.data.isDarkMode,m.switchMode(s);break;case"delete-all-user-data-from-storage":m.clearAllDataInStorage(!0);break;case"get-domain":m.sendinitConfToPopin()}else"toggle-popin"===e.data.popinAction&&m.toggle()})};m.sendinitConfToPopin=()=>{f.POPIN_MANAGER.popin.contentWindow.postMessage({domain:window.location.origin},"*")}}})(FACIL_ITI),(l=>{l.INCONTENT_MANAGER={};{var c=l.INCONTENT_MANAGER;let n="FACIL_ITI_INCONTENT",o="https://web-service.facil-iti.app",a={origin:{source:"tag",version:"cdn"}},r=!1,s=(c.inContent=null,c.nodeMetaData=new WeakMap,c.context=()=>{var e=document.documentElement.lang.split(/[-_]/)[0].toLowerCase();return{id:"incontent-context",currentURL:window.location.href,width:window.innerWidth,height:window.innerHeight,lang:e,isDesktopView:!1,isMobileView:!1,applicationIdentifier:void 0!==l.configuration?l.configuration.applicationIdentifier:null,uiVersion:void 0!==l.configuration?l.configuration.uiVersion:"default",iframeTitle:"fr"===e?"Solution de personnalisation de lâ€™affichage":"Display Personalization Solution"}},{app_url:o,features:"env_1",ui:{css:{height:"100%",width:"100%"},stylesheet:""}});c.applyLayout=function(){try{var e,t,i=document.querySelector("#"+n);for([e,t]of Object.entries(s.ui.css))i.style[e]=t}catch{}},c.applyConfiguration=()=>{try{document.querySelector("#"+n).contentWindow.postMessage(c.context(),"*")}catch{}},c.setup=function(e=c.context()){r=null!==document.querySelector("iframe#FACIL_ITI_INCONTENT"),c.open("[data-faciliti-incontent]",e)},c.countOpening=function(e,t,i){i=JSON.stringify(i),fetch(o+`/popin/opening/${e}/${t}/`+i,{method:"HEAD",mode:"no-cors"}).catch()},c.open=function(e,t){var i,e=document.querySelector(e);null===e||r||(window.addEventListener("message",e=>{["https://cdn.facil-iti.app","https://popin.wip"].includes(e.origin)&&"get-domain"===e.data.popinAction&&document.querySelector("#"+n).contentWindow.postMessage({domain:window.location.origin},"*")}),c.countOpening(t.applicationIdentifier,"in-content",a),c.nodeMetaData.set(e,{toggleButtonActivated:!0}),(i=document.createElement("iframe")).title=c.context().iframeTitle,i.src=o+"/popin/router/"+t.applicationIdentifier+"/in-content",i.id=n,(c.inContent=i).onload=c.applyConfiguration,e.appendChild(i),c.applyLayout(),document.querySelector("#"+n).addEventListener("mouseenter",l.POPIN_MANAGER.disableScroll),document.querySelector("#"+n).addEventListener("mouseleave",l.POPIN_MANAGER.enableScroll),r=!0)}}})(FACIL_ITI),(n=>{let o="bbfd28ea-b7fa-4739-9bc3-5a76a189bff4",a=new Set;function t(){a.forEach(e=>{try{e.undoChange(),a.delete(e)}catch{}})}n.AUTOMATIC_FEATURES_MANAGER={processModules:function(e,i){t(),e.forEach(t=>{var e;e=t.name,n.configuration.applicationIdentifier===o&&["contrast","dalto","darker"].includes(e)&&document.location.pathname.includes("/2024/exhibitors/")||import(t.src).then(e=>{if(!e.default)throw new Error(`Module ${t.src} does not have a default export`);e=new e.default;a.add(e),e.setOptions(i),e.applyChange()}).catch(()=>{})})},cancelModules:t}})(window.FACIL_ITI),(g=>{g.POC_PLAIN_LANGUAGE={};{var f=g.POC_PLAIN_LANGUAGE;let e="initial",n={},o={},i="Passer en langage clair";var m="#ffffff",h="#a8002d";let a=[{plain_language:"<h2>Notre politique</h2> <p>Nous avons mis en place une politique de confidentialitÃ© des donnÃ©es pour Ãªtre conformes au RÃ¨glement GÃ©nÃ©ral sur la Protection des DonnÃ©es.</p><p>Nous vous informons Ã  chaque fois de lâ€™utilisation des donnÃ©es que vous renseignez.</p><p>Des donnÃ©es personnelles vous seront demandÃ©es Ã  la page contact ou lors dâ€™une candidature.</p><p>Votre adresse email vous sera demandÃ©e si vous souhaitez recevoir notre newsletter.</p><p>Pour toutes questions sur vos donnÃ©es personnelles, vous pouvez nous Ã©crire Ã  <a href='mailto:privacy@facil-iti.com.'>privacy@facil-iti.com.</a></p><p>[En plus du respect de la loi informatique et libertÃ© du 6 janvier 1978, nous nous engageons Ã  respecter le RÃ¨glement (UE) 2016/679 du Parlement europÃ©en et du Conseil du 27 avril 2016, dÃ¨s son entrÃ©e en vigueur le 25 mai 2018].</p><h2>Qui collecte les donnÃ©es ?</h2> <p>Nous sommes responsables des traitements effectuÃ©s sur vos donnÃ©es personnelles.</p><p>Notre siÃ¨ge social est Ã  lâ€™adresse suivante : FACILâ€™iti, ESTER Technopole, 16 rue Soyouz, 87068 Limoges.</p><h2>Quelles sont les finalitÃ©s</h2> <p><strong>Quelles sont vos donnÃ©es personnelles Ã  renseigner dans le formulaire de contact ?</strong></p><p>Pour nous contacter, vous devez renseigner : votre nom(s) et prÃ©nom(s), votre adresse e-mail, un objet du message et le message, et votre numÃ©ro de tÃ©lÃ©phone si vous le souhaitez.</p><p>Nous utiliserons vos donnÃ©es que pour revenir vers vous et rÃ©pondre au mieux Ã  vos besoins.</p><p><strong>Comment recevoir la newsletter ?</strong></p><p>Pour recevoir la newsletter, vous devez nous communiquer votre adresse e-mail.</p><p>Votre adresse e-mail sera utilisÃ©e uniquement pour vous envoyer la newsletter.</p><p>Sur chaque newsletter, il existe un lien que lequel vous pouvez cliquer pour ne plus recevoir la newsletter.</p>",target:{type:"selector",value:"#contenu .free-content",url:"/donnees-personnelles"}},{plain_language:"<p>Comment la solution FACIL'iti a-t-elle Ã©tÃ© crÃ©Ã©e ?</p><p>On vous explique tout dans cet article.</p>",target:{type:"content",value:"Vous Ãªtes nombreux Ã  nous demander comment est nÃ©e FACILâ€™iti. Quelle a Ã©tÃ© lâ€™idÃ©e de dÃ©part ? Comment les filtres FACILâ€™iti ont-ils Ã©tÃ© crÃ©Ã©s ? Quels sont les acteurs qui ont participÃ© Ã  la construction de notre outil de personnalisation web ?Remontons le temps pour dÃ©couvrir les coulisses du lancement de notre outil dâ€™inclusion numÃ©riqueâ€¦ [â€¦]",url:"/blog"}},{plain_language:"<p>Mardi 22 fÃ©vrier, le Magazine de la SantÃ© parle de FACIL'iti.</p><p>Un trÃ¨s beau reportage sur notre solution d'inclusion numÃ©rique</p><p>Cliquez ici pour Voir la vidÃ©o.</p>",target:{type:"content",value:"Dans son Ã©mission du mardi 22 fÃ©vrier, le Magazine de la SantÃ© a consacrÃ© un trÃ¨s beau reportage Ã  notre outil dâ€™inclusion numÃ©rique. Une belle surprise pour toute lâ€™Ã©quipe de FACILâ€™iti ! Voir la vidÃ©o : Version texte : Â«&nbsp;(Marina) Rym, vous allez nous parler dâ€™un outil trÃ¨s pratique pour les personnes qui ont des [â€¦]",url:"/blog"}}],r="button.plain-language-toggle-button {display: flex;align-items: center;justify-content: center;flex-direction: row;color: "+m+";font-size: 1em;background: "+h+";padding: 5px 10px;border: 2px solid "+h+";border-radius: 5px;transition: all ease 300ms;margin:15px 0;}button.plain-language-toggle-button svg{width : 20px;height: 20px; fill:"+m+";margin-right:10px;transition: all ease 300ms;}button.plain-language-toggle-button p{width: auto;margin: 0;padding: 0; color: "+m+" !important;transition: all ease 300ms;}button.plain-language-toggle-button:hover {color: "+h+";background: "+m+";border: 2px solid "+h+";}button.plain-language-toggle-button:hover svg{fill:"+h+";}button.plain-language-toggle-button:hover p{color: "+h+" !important}}";function w(e,t){return n[e]=document.querySelector(t.target.value),n[e].parentNode}function v(e,t){return n[e]=s(t.target.value)[0],s(t.target.value)[0].parentElement}f.setup=function(){let t=!1;a.forEach(function(e){window.location.href.includes(e.target.url)&&(t=!0)}),t&&(d(),p(),window.addEventListener("keydown",function(e){e.ctrlKey&&e.shiftKey&&"KeyL"===e.code&&g.POC_PLAIN_LANGUAGE.togglePlainLanguage()}))},f.togglePlainLanguage=function(){("initial"===e?(e="plain",i="Revenir au texte initial",l):(e="initial",i="Passer en langage clair",c))(),I(),t()};let s=function(t){return[...document.querySelectorAll("body *")].filter(e=>{if(e.innerHTML===t)return e})},t=function(){try{document.querySelector("#FACIL_ITI_POPIN").contentWindow.postMessage(e,"*")}catch{}},l=function(){a.forEach(function(e,t){o[t]=document.createElement("div"),o[t].classList.add("facil-iti-plain-language","plain-language-text-"+t),o[t].innerHTML=e.plain_language,"selector"===e.target.type&&window.location.href.includes(e.target.url)&&w(t,e).replaceChild(o[t],n[t]),"content"===e.target.type&&window.location.href.includes(e.target.url)&&0<s(e.target.value).length&&v(t,e).replaceChild(o[t],n[t])})},c=function(){if(n&&o)for(var[e,t]of Object.entries(o)){var i=document.querySelector(".plain-language-text-"+e);i&&i.parentElement&&i.parentElement.replaceChild(n[e],t)}},d=function(){a.forEach(function(e,t){document.querySelector(".facil-iti-plain-language-toggle")||("selector"===e.target.type&&window.location.href.includes(e.target.url)&&w(t,e).insertBefore(u(),n[t]),"content"===e.target.type&&window.location.href.includes(e.target.url)&&0<s(e.target.value).length&&v(t,e).insertBefore(u(),n[t]))})};function I(){document.querySelectorAll("button.plain-language-toggle-button").forEach(e=>{e.children[1].innerHTML=i,e.setAttribute("aria-label",i),e.setAttribute("aria-selected",!0)})}let u=function(){var e=document.createElement("button"),t=(e.classList.add("plain-language-toggle-button"),e.setAttribute("aria-label",i),e.setAttribute("aria-selected",!1),e.onclick=function(e){g.POC_PLAIN_LANGUAGE.togglePlainLanguage(),I(),e.stopPropagation()},document.head.appendChild(document.createElement("style")).innerHTML=r,document.createElement("svg")),t=(t.innerHTML='<svg version="1.1" aria-hidden="true" focusable="false" role="image" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 6.2 8" style="enable-background:new 0 0 6.2 8;" xml:space="preserve"><g><path className="st0" d="M4.5,0.2v1.4c0,0.1,0.1,0.1,0.1,0.1H6L4.5,0.2z"/><path className="st0" d="M3.9,1.9V0H0.2C0.1,0,0,0.1,0,0.2v7.6C0,7.9,0.1,8,0.2,8H6c0.1,0,0.2-0.1,0.2-0.2V2.3H4.4C4.1,2.3,3.9,2.1,3.9,1.9z M1.3,1.2h1.2c0.2,0,0.3,0.1,0.3,0.3S2.7,1.9,2.5,1.9H1.3c-0.2,0-0.3-0.1-0.3-0.3S1.1,1.2,1.3,1.2z M5,6.8H1.3c-0.2,0-0.3-0.1-0.3-0.3s0.1-0.3,0.3-0.3H5c0.2,0,0.3,0.1,0.3,0.3S5.1,6.8,5,6.8z M5,5.1H1.3C1.1,5.1,0.9,5,0.9,4.8s0.1-0.3,0.3-0.3H5c0.2,0,0.3,0.1,0.3,0.3S5.1,5.1,5,5.1z M5.3,3.2c0,0.2-0.1,0.3-0.3,0.3H1.3c-0.2,0-0.3-0.1-0.3-0.3s0.1-0.3,0.3-0.3H5C5.1,2.9,5.3,3,5.3,3.2z"/></g></svg>',e.appendChild(t),document.createElement("p"));return t.innerHTML=i,e.appendChild(t),e},p=function(){window.addEventListener("message",e=>{["https://web-service.facil-iti.app","https://www.facil-iti.app","https://cdn.facil-iti.app"].includes(e.origin)&&("toggle-plain-language"===e.data.popinAction?g.POC_PLAIN_LANGUAGE.togglePlainLanguage():"get-toggle-plain-language"===e.data.popinAction&&t())})}}})(FACIL_ITI),FACIL_ITI||={},Object.assign(window.FACIL_ITI,{iframePilote:new class{registeredIframes=[];dialogWithParentWindowEstablished=!1;dialogueAttemptCounter=0;initialize(){this.isInIframe()?this.childInitialization():this.parentInitialization()}isMainTag(){return!this.dialogWithParentWindowEstablished}isInIframe(){try{return window.self!==window.top}catch(e){return!0}}synchroniseToRegisteredIframes(){this.registeredIframes.forEach(e=>{var t={subject:"faciliti:filter-store-change",content:window.FACIL_ITI.loadFilterStore()};e.postMessage(t,"*")})}parentInitialization(){window.addEventListener("message",e=>{var t;e.data.subject&&"faciliti:register-iframe"===e.data.subject&&(this.registeredIframes.push(e.source),t={subject:"faciliti:filter-store-change",content:window.FACIL_ITI.loadFilterStore()},e.source.postMessage(t,"*"))})}childInitialization(){window.addEventListener("message",e=>{e.data.subject&&"faciliti:filter-store-change"===e.data.subject&&(this.dialogWithParentWindowEstablished=!0,window.FACIL_ITI.saveFilters(JSON.stringify(e.data.content)))});{let e={subject:"faciliti:register-iframe",content:window.origin},t=()=>{this.dialogWithParentWindowEstablished||(this.dialogueAttemptCounter++,window.top?.postMessage(e,"*"),this.dialogueAttemptCounter<15&&setTimeout(t,1e3))};t()}}}}),(o=>{let a={applicationIdentifier:null,webServiceUrl:"https://ws.facil-iti.com",domains:[],uiVersion:"default"},r=null,i="blue",n="green",t=null,s=null,l=null,c=[];function d(){for(var e in o.reset)if(Object.hasOwn(o.reset,e)&&"extend"!==e&&-1<o.executedFunctions.indexOf(e))try{o.reset[e]()}catch{}}function u(e,t){let i=[];return e.forEach(function(e){0<e.addedNodes.length&&Array.from(e.addedNodes).forEach(e=>{void 0!==e.dataset&&void 0!==e.dataset[t]?i.push(e):e.hasChildNodes()&&(i=i.concat(...e.querySelectorAll("*[data-faciliti-popin]")))})}),i}function p(e){e.preventDefault(),o.POPIN_MANAGER.toggle()}function g(e){if(e&&!e.url_blacklist.some(e=>RegExp(e,"gi").test(location.pathname))){e.preprocessing_modules.forEach(e=>{import(e).then(e=>(c.push(e),e)).then(e=>e.applyDomTransformations())}),d();var t=e.css;if(t&&0!==t.length){t=t.reduce((e,t)=>e+t.content,"").replace(/#FACIL_ITI_DOMAIN#/g,a.webServiceUrl);let e=document.querySelector("style[data-faciliti-style]");null!==e?e.innerHTML=t:((e=document.createElement("style")).dataset.facilitiStyle="",e.innerHTML=t,document.body.appendChild(e))}(t=e.stylesheets)&&0!==t.length&&(document.querySelectorAll("link[data-faciliti-stylesheet='"+n+"']").forEach(e=>e.remove()),t.map(e=>a.webServiceIntegrationUrl+e).forEach(e=>{var t=document.createElement("link");t.dataset.facilitiStylesheet=i,t.setAttribute("rel","stylesheet"),t.setAttribute("href",e),document.head.appendChild(t)}),[i,n]=[n,i]);t=e;if(t.js&&t.js.length){let e=document.querySelector("script[data-faciliti-script]");e&&e.remove(),(e=document.createElement("script")).dataset.facilitiScript="features",e.setAttribute("src",a.webServiceUrl+"/"+t.engine),e.setAttribute("crossorigin","anonymous"),t.engine_integrity&&e.setAttribute("integrity",t.engine_integrity),document.head.appendChild(e)}t=e.features,document.documentElement.dataset.faciliti=t.join(" "),o.AUTOMATIC_FEATURES_MANAGER.processModules(e.feature_modules,e.config)}}function f(){var e=JSON.parse(localStorage.getItem("FACIL_ITI"));return e?void 0===e.version||1===e.version?FilterStoreV2.createFromStoreV1(e):FilterStoreV2.loadFromRawJsonObject(e):new FilterStoreV2}function e(){s=f();var e=a;try{s.isActiveFilter()&&s.getActiveFilter()?.areThereAnyActiveFunctions()&&(e.language=s.getActiveFilter().language);var t=document.querySelector("script[data-application-identifier]");t.dataset.applicationIdentifier&&(t.dataset.applicationIdentifier=t.dataset.applicationIdentifier.trim(),n=new RegExp(/^[A-Za-z0-9]{8}-(?:[A-Za-z0-9]{4}-){3}[A-Za-z0-9]{12}$/g),t.dataset.applicationIdentifier.match(n)||console.log("FACIL-ITI INFO: wrong format for applicationIdentifier")),Object.assign(e,{...t.dataset})}catch{}s.isActiveFilter()&&s.getActiveFilter()?.areThereAnyActiveFunctions()&&sessionStorage.getItem("FACIL_ITI_CACHE")&&g(r=JSON.parse(sessionStorage.getItem("FACIL_ITI_CACHE")));try{o.INCONTENT_MANAGER.setup(a)}catch{}try{o.POPIN_MANAGER.setup(a)}catch{}try{o.configuration.uiVersion&&"staging"===o.configuration.uiVersion&&"9c57a7db-d64b-11e5-8f05-000c298ed446"===a.applicationIdentifier&&o.POC_PLAIN_LANGUAGE.setup()}catch{}o.iframePilote.initialize();{let i=new MutationObserver(function(e){e=u(e,"facilitiPopin");let t=!1;0<e.length&&(e.forEach(e=>{o.POPIN_MANAGER.nodeMetaData.has(e)&&o.POPIN_MANAGER.nodeMetaData.get(e).toggleButtonActivated||(o.POPIN_MANAGER.nodeMetaData.set(e,{toggleButtonActivated:!0}),e.addEventListener("click",p),t=!1)}),t)&&i.disconnect()});i.observe(document.body,{subtree:!0,childList:!0})}{let i=new MutationObserver(function(e){e=u(e,"facilitiIncontent");let t=!1;0<e.length&&(e.forEach(e=>{o.INCONTENT_MANAGER.nodeMetaData.has(e)&&o.INCONTENT_MANAGER.nodeMetaData.get(e).toggleButtonActivated||(o.INCONTENT_MANAGER.nodeMetaData.set(e,{inContentContainerActivated:!0}),o.INCONTENT_MANAGER.setup(),t=!0)}),t)&&i.disconnect()});i.observe(document.body,{subtree:!0,childList:!0})}function i(e){e.href.startsWith("https://ws.facil-iti.com/")&&(e.dataset.facilitiPopin||(e.dataset.facilitiPopin=""),e.setAttribute("href","#"),e.removeAttribute("target"),e.setAttribute("rel","noopener noreferrer"),e.addEventListener("click",()=>(o.POPIN_MANAGER.toggle(),!1)))}var n=new MutationObserver(e=>{e.forEach(e=>{"childList"===e.type&&e.addedNodes.forEach(e=>"A"===e.tagName?i(e):e.querySelectorAll("a").forEach(i))})});try{["24a8211d-c004-4efd-ae2b-dd4b1bff8221","3889ec87-602b-11e9-acfc-0242ac130002"].includes(a.applicationIdentifier)&&(window.document.querySelectorAll("a").forEach(i),n.observe(window.document,{childList:!0,attributes:!1,subtree:!0}))}catch{}}async function m(){var e,t,i;window.postMessage&&window.postMessage("faciliti:initialization"),(s=f()).isActiveFilter()&&s.getActiveFilter()?.areThereAnyActiveFunctions()?l!==s.getActiveFilter().config&&(r=(e=a.applicationIdentifier,t=s.getActiveFilter().config,(i="https://ws.facil-iti.com"===a.webServiceUrl?new URL("https://web-service.facil-iti.app/faciliti/adaptation"):new URL(a.webServiceUrl+"/tag/engine/")).searchParams.append("params",t),i.searchParams.append("id",e),await(await fetch(i,{})).json()),l=s.getActiveFilter().config,JSON.stringify(r)!==sessionStorage.getItem("FACIL_ITI_CACHE"))&&(g(r),sessionStorage.setItem("FACIL_ITI_CACHE",JSON.stringify(r)),o.POPIN_MANAGER.redraw()):(d(),o.AUTOMATIC_FEATURES_MANAGER.cancelModules(),(t=document.querySelector("script[data-faciliti-script]"))&&t.remove(),(t=document.querySelector("style[data-faciliti-style]"))&&t.remove(),delete document.documentElement.dataset.faciliti,c.forEach(e=>e.undoDomTransformations()),sessionStorage.removeItem("FACIL_ITI_CACHE"))}function h(e){let t=null;var i=document.querySelector("#FACIL_ITI_POPIN"),n=document.querySelector("#FACIL_ITI_INCONTENT");if(i&&(t=i.contentWindow||i),t=n?n.contentWindow||n:t){i=localStorage.getItem("FACIL_ITI")||{};try{t.postMessage(i,e)}catch{}}}function w(e){window.localStorage.setItem("FACIL_ITI",e),window.dispatchEvent(new StorageEvent("storage",{key:"FACIL_ITI"})),s=f(),h("*")}function v(e,t){this[e]=this[e]||t}try{switch(Object.assign(o,{conf:()=>!0,configuration:a,getAdaptationData:function(){return r},loadFilterStore:f,saveFilters:w,version:"2.1.0",executedFunctions:[],page:document,reset:{extend:v},utilities:{extend:v},modules:{extend:v},initialize:e,execute:m,apply:function(){e(),m()}}),window.addEventListener("message",function(e){try{if(!["https://www.facil-iti.app","https://cdn.facil-iti.app"].includes(e.origin))return!1;var t="string"==typeof e.data?JSON.parse(e.data):e.data;switch(t.subject){case"save-filters":w(t.content),o.iframePilote.synchroniseToRegisteredIframes();break;case"load-filters":h(e.origin)}}catch{}}),window.addEventListener("storage",function(e){"FACIL_ITI"===e.key&&(clearTimeout(t),t=setTimeout(m,200))}),document.addEventListener("pageChanged",()=>{o.initialize(),o.execute()}),document.addEventListener("readystatechange",()=>{switch(document.readyState){case"interactive":e();break;case"complete":m()}}),document.readyState){case"interactive":e();break;case"complete":e(),m()}}catch{}})(FACIL_ITI);
